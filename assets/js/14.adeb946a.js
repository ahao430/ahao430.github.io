(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{180:function(t,e,s){"use strict";s.r(e);var a=s(0),r=Object(a.a)({},(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"vue-cli项目的环境编译"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-cli项目的环境编译"}},[t._v("#")]),t._v(" vue-cli项目的环境编译")]),t._v(" "),s("p",[t._v("要将vue项目部署到两个不同的环境，其中域名等变量不一样。如果是自己配置的vue，当然可以通过cross-env来在命令中插入环境变量。但是vue-cli的编译命令并不是node命令，而是vue-cli-service命令，这时可以通过--mode参数来添加环境变量。")]),t._v(" "),s("h4",{attrs:{id:"env配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#env配置文件"}},[t._v("#")]),t._v(" .env配置文件")]),t._v(" "),s("p",[t._v("在根目录中新建几个配置文件，用于设置环境变量。然后在命令中使用。\n这里我新建了四个配置文件，分别是.env.dev-test, .env.dev-prod, .env.build-test, .env.build-prod。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# .env.dev-test\nNODE_ENV=development\nVUE_APP_ENV=test\n\n# .env.dev-test\nNODE_ENV=development\nVUE_APP_ENV=prod\n\n# .env.dev-test\nNODE_ENV=production\nVUE_APP_ENV=test\n\n# .env.dev-test\nNODE_ENV=production\nVUE_APP_ENV=prod\n")])])]),s("p",[t._v("虽然原先的serve和build命令会设置NODE_ENV，但是使用--mode后，这个参数会丢失，因此需要再写一次。")]),t._v(" "),s("h4",{attrs:{id:"配置命令-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置命令-mode"}},[t._v("#")]),t._v(" 配置命令--mode")]),t._v(" "),s("p",[t._v("配置package.json命令如下：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"start"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service serve --mode dev-test"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"serve"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service serve --mode dev-test"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dev"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service serve --mode dev-test"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dev:test"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service serve --mode dev-test"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dev:prod"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service serve --mode dev-prod"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service build --mode build-prod"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build:test"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service build --mode build-test"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build:prod"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service build --mode build-prod"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这样不同的命令会携带不同的环境变量。\n在项目配置文件中，通过process.env.VUE_APP_ENV命令，来判断环境是test还是prod。")])])}],!1,null,null,null);e.default=r.exports}}]);